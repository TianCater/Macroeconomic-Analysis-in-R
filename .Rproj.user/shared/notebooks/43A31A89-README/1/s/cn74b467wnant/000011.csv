"0","#Re-creation of Stock and Watson (2001)"
"0","#https://faculty.washington.edu/ezivot/econ584/stck_watson_var.pdf"
"0","library(quantmod)"
"0","library(vars)"
"0","getSymbols(c('GDPCTPI','UNRATE','FEDFUNDS'),src='FRED')"
"1","[1]"
"1"," ""GDPCTPI"" "
"1"," ""UNRATE""  "
"1"," ""FEDFUNDS"""
"1","
"
"0","#Ordering of variables matters for impulse response functions"
"0","macro_data <- merge(GDPCTPI,UNRATE,FEDFUNDS)"
"0","macro_data <- na.omit(macro_data)"
"0","macro_data[,1] <- 400*Delt(macro_data[,1],type = 'log')"
"0","macro_data <- na.omit(macro_data)"
"0","macro_data <- macro_data['1960-01-01'<=index(macro_data)&index(macro_data) < '2001-01-01',]"
"0","# head(macro_data)"
"0","# tail(macro_data)"
"0","# VARselect(macro_data)"
"0","mdl <- VAR(macro_data,p = 4)"
"0","summary(mdl)"
"1","
VAR Estimation Results:
"
"1","========================="
"1"," "
"1","
"
"1","Endogenous variables: GDPCTPI, UNRATE, FEDFUNDS 
"
"1","Deterministic variables: const 
"
"1","Sample size: 160 
"
"1","Log Likelihood: -462.63 
"
"1","Roots of the characteristic polynomial:
"
"1","0.9667"
"1"," "
"1","0.9667"
"1"," "
"1","0.7718"
"1"," "
"1","0.7718"
"1"," "
"1","0.6047"
"1"," "
"1","0.6047"
"1"," "
"1","0.5894"
"1"," "
"1","0.5894"
"1"," "
"1","0.5482"
"1"," "
"1","0.5482"
"1"," "
"1","0.4977"
"1"," "
"1","0.4079"
"1","
Call:
"
"1","VAR(y = macro_data, p = 4)
"
"1","

"
"1","Estimation results for equation GDPCTPI:"
"1"," "
"1","
"
"1","========================================"
"1"," "
"1","
"
"1","GDPCTPI = GDPCTPI.l1 + UNRATE.l1 + FEDFUNDS.l1 + GDPCTPI.l2 + UNRATE.l2 + FEDFUNDS.l2 + GDPCTPI.l3 + UNRATE.l3 + FEDFUNDS.l3 + GDPCTPI.l4 + UNRATE.l4 + FEDFUNDS.l4 + const"
"1"," "
"1","

"
"1","           "
"1","  Estimate"
"1"," Std. Error"
"1"," t value"
"1","         Pr(>|t|)"
"1","    "
"1","
GDPCTPI.l1 "
"1","  0.645446"
"1","   0.084226"
"1","   7.663"
"1"," 0.00000000000226"
"1"," ***"
"1","
UNRATE.l1  "
"1"," -0.733797"
"1","   0.318285"
"1","  -2.305"
"1","           0.0225"
"1"," *  "
"1","
FEDFUNDS.l1"
"1","  0.020804"
"1","   0.074817"
"1","   0.278"
"1","           0.7814"
"1","    "
"1","
GDPCTPI.l2 "
"1","  0.081650"
"1","   0.099882"
"1","   0.817"
"1","           0.4150"
"1","    "
"1","
UNRATE.l2  "
"1","  1.000368"
"1","   0.481101"
"1","   2.079"
"1","           0.0393"
"1"," *  "
"1","
FEDFUNDS.l2"
"1","  0.006032"
"1","   0.081147"
"1","   0.074"
"1","           0.9408"
"1","    "
"1","
GDPCTPI.l3 "
"1","  0.117731"
"1","   0.100063"
"1","   1.177"
"1","           0.2413"
"1","    "
"1","
UNRATE.l3  "
"1"," -0.796323"
"1","   0.493736"
"1","  -1.613"
"1","           0.1089"
"1","    "
"1","
FEDFUNDS.l3"
"1"," -0.019124"
"1","   0.080221"
"1","  -0.238"
"1","           0.8119"
"1","    "
"1","
GDPCTPI.l4 "
"1","  0.160573"
"1","   0.087189"
"1","   1.842"
"1","           0.0675"
"1"," .  "
"1","
UNRATE.l4  "
"1","  0.389230"
"1","   0.301699"
"1","   1.290"
"1","           0.1990"
"1","    "
"1","
FEDFUNDS.l4"
"1"," -0.027207"
"1","   0.075305"
"1","  -0.361"
"1","           0.7184"
"1","    "
"1","
const      "
"1","  0.950849"
"1","   0.374926"
"1","   2.536"
"1","           0.0123"
"1"," *  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.997"
"1"," "
"1","on"
"1"," "
"1","147"
"1"," "
"1","degrees of freedom
"
"1","Multiple R-Squared:"
"1"," "
"1","0.8516"
"1",",	Adjusted R-squared:"
"1"," "
"1","0.8395"
"1"," "
"1","
F-statistic:"
"1"," "
"1","70.32"
"1"," "
"1","on"
"1"," "
"1","12"
"1"," "
"1","and"
"1"," "
"1","147"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1"," "
"1","
"
"1","

"
"1","Estimation results for equation UNRATE:"
"1"," "
"1","
"
"1","======================================="
"1"," "
"1","
"
"1","UNRATE = GDPCTPI.l1 + UNRATE.l1 + FEDFUNDS.l1 + GDPCTPI.l2 + UNRATE.l2 + FEDFUNDS.l2 + GDPCTPI.l3 + UNRATE.l3 + FEDFUNDS.l3 + GDPCTPI.l4 + UNRATE.l4 + FEDFUNDS.l4 + const"
"1"," "
"1","

"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1"," Pr(>|t|)"
"1","    "
"1","
GDPCTPI.l1 "
"1","  0.02822"
"1","    0.02317"
"1","   1.218"
"1","    0.225"
"1","    "
"1","
UNRATE.l1  "
"1","  1.27805"
"1","    0.08757"
"1","  14.594"
"1","   <2e-16"
"1"," ***"
"1","
FEDFUNDS.l1"
"1","  0.01309"
"1","    0.02058"
"1","   0.636"
"1","    0.526"
"1","    "
"1","
GDPCTPI.l2 "
"1"," -0.01857"
"1","    0.02748"
"1","  -0.676"
"1","    0.500"
"1","    "
"1","
UNRATE.l2  "
"1"," -0.18254"
"1","    0.13237"
"1","  -1.379"
"1","    0.170"
"1","    "
"1","
FEDFUNDS.l2"
"1","  0.02060"
"1","    0.02233"
"1","   0.923"
"1","    0.358"
"1","    "
"1","
GDPCTPI.l3 "
"1","  0.01560"
"1","    0.02753"
"1","   0.567"
"1","    0.572"
"1","    "
"1","
UNRATE.l3  "
"1"," -0.11783"
"1","    0.13585"
"1","  -0.867"
"1","    0.387"
"1","    "
"1","
FEDFUNDS.l3"
"1","  0.03288"
"1","    0.02207"
"1","   1.490"
"1","    0.138"
"1","    "
"1","
GDPCTPI.l4 "
"1"," -0.02044"
"1","    0.02399"
"1","  -0.852"
"1","    0.396"
"1","    "
"1","
UNRATE.l4  "
"1"," -0.03459"
"1","    0.08301"
"1","  -0.417"
"1","    0.678"
"1","    "
"1","
FEDFUNDS.l4"
"1"," -0.03133"
"1","    0.02072"
"1","  -1.512"
"1","    0.133"
"1","    "
"1","
const      "
"1","  0.07860"
"1","    0.10316"
"1","   0.762"
"1","    0.447"
"1","    "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","0.2743"
"1"," "
"1","on"
"1"," "
"1","147"
"1"," "
"1","degrees of freedom
"
"1","Multiple R-Squared:"
"1"," "
"1"," 0.97"
"1",",	Adjusted R-squared:"
"1"," "
"1","0.9675"
"1"," "
"1","
F-statistic:"
"1"," "
"1","396.1"
"1"," "
"1","on"
"1"," "
"1","12"
"1"," "
"1","and"
"1"," "
"1","147"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1"," "
"1","
"
"1","

"
"1","Estimation results for equation FEDFUNDS:"
"1"," "
"1","
"
"1","========================================="
"1"," "
"1","
"
"1","FEDFUNDS = GDPCTPI.l1 + UNRATE.l1 + FEDFUNDS.l1 + GDPCTPI.l2 + UNRATE.l2 + FEDFUNDS.l2 + GDPCTPI.l3 + UNRATE.l3 + FEDFUNDS.l3 + GDPCTPI.l4 + UNRATE.l4 + FEDFUNDS.l4 + const"
"1"," "
"1","

"
"1","           "
"1"," Estimate"
"1"," Std. Error"
"1"," t value"
"1","     Pr(>|t|)"
"1","    "
"1","
GDPCTPI.l1 "
"1","  0.09679"
"1","    0.10089"
"1","   0.959"
"1","      0.33893"
"1","    "
"1","
UNRATE.l1  "
"1"," -2.06382"
"1","    0.38125"
"1","  -5.413"
"1"," 0.0000002462"
"1"," ***"
"1","
FEDFUNDS.l1"
"1","  0.51743"
"1","    0.08962"
"1","   5.774"
"1"," 0.0000000444"
"1"," ***"
"1","
GDPCTPI.l2 "
"1","  0.09177"
"1","    0.11964"
"1","   0.767"
"1","      0.44429"
"1","    "
"1","
UNRATE.l2  "
"1","  1.85987"
"1","    0.57627"
"1","   3.227"
"1","      0.00154"
"1"," ** "
"1","
FEDFUNDS.l2"
"1","  0.09509"
"1","    0.09720"
"1","   0.978"
"1","      0.32955"
"1","    "
"1","
GDPCTPI.l3 "
"1","  0.12299"
"1","    0.11986"
"1","   1.026"
"1","      0.30652"
"1","    "
"1","
UNRATE.l3  "
"1"," -0.57759"
"1","    0.59141"
"1","  -0.977"
"1","      0.33036"
"1","    "
"1","
FEDFUNDS.l3"
"1","  0.21640"
"1","    0.09609"
"1","   2.252"
"1","      0.02580"
"1"," *  "
"1","
GDPCTPI.l4 "
"1"," -0.06308"
"1","    0.10444"
"1","  -0.604"
"1","      0.54676"
"1","    "
"1","
UNRATE.l4  "
"1","  0.59005"
"1","    0.36138"
"1","   1.633"
"1","      0.10466"
"1","    "
"1","
FEDFUNDS.l4"
"1","  0.07859"
"1","    0.09020"
"1","   0.871"
"1","      0.38500"
"1","    "
"1","
const      "
"1","  0.81546"
"1","    0.44910"
"1","   1.816"
"1","      0.07144"
"1"," .  "
"1","
"
"1","---
Signif. codes:  "
"1",""
"1","0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1"
"1","
"
"1","
"
"1","
Residual standard error:"
"1"," "
"1","1.194"
"1"," "
"1","on"
"1"," "
"1","147"
"1"," "
"1","degrees of freedom
"
"1","Multiple R-Squared:"
"1"," "
"1","0.8792"
"1",",	Adjusted R-squared:"
"1"," "
"1","0.8694"
"1"," "
"1","
F-statistic:"
"1"," "
"1"," 89.2"
"1"," "
"1","on"
"1"," "
"1","12"
"1"," "
"1","and"
"1"," "
"1","147"
"1"," "
"1","DF,  p-value:"
"1"," "
"1","< 2.2e-16"
"1"," "
"1","
"
"1","

"
"1","
Covariance matrix of residuals:
"
"1","        "
"1","  GDPCTPI"
"1","   UNRATE"
"1"," FEDFUNDS"
"1","
GDPCTPI "
"1","  0.99402"
"1"," -0.05388"
"1","   0.2852"
"1","
UNRATE  "
"1"," -0.05388"
"1","  0.07525"
"1","  -0.1281"
"1","
FEDFUNDS"
"1","  0.28518"
"1"," -0.12814"
"1","   1.4262"
"1","
"
"1","
Correlation matrix of residuals:
"
"1","        "
"1"," GDPCTPI"
"1","  UNRATE"
"1"," FEDFUNDS"
"1","
GDPCTPI "
"1","  1.0000"
"1"," -0.1970"
"1","   0.2395"
"1","
UNRATE  "
"1"," -0.1970"
"1","  1.0000"
"1","  -0.3912"
"1","
FEDFUNDS"
"1","  0.2395"
"1"," -0.3912"
"1","   1.0000"
"1","
"
"1","

"
"0","#Size of Shocks#"
"0","# summary(mdl)$varresult$GDPCTPI$sigma"
"0","# summary(mdl)$varresult$UNRATE$sigma"
"0","# summary(mdl)$varresult$FEDFUNDS$sigma"
"0","cpi_irf <- irf(mdl,impulse = 'GDPCTPI',ortho = F,n.ahead = 24,ci=0.66,runs = 300)"
"0","par(mfrow=c(1,3))"
"0","plot(cpi_irf$irf$GDPCTPI[,1],typ='l',ylab='Inflation')"
